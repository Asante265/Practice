<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.5.0/dist/chart.umd.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <title>My Chart</title>
</head>
<body>
    <Section class="container">
        <canvas id="myChart"></canvas>
        <button onclick="updateChart"> Fetch Now</button>
    </Section>

    <script>
        function updateChart(){
        async function fetchData() {
            const url = 'http://localhost/chartjs/project/finance.json';
            const response = await fetch(url);
             
            const data = await response.json();
            console.log(data);
            return data;
        };
        fetchData().then(data => {
            const month = data.financialreport[0].financials.map(
                function(index){
                    return index.date; 
                }
            )
            console.log(month);

            myChart.data.labels = month;
            myChart.update();
        })
    }
        let myChart = document.getElementById('myChart').getContext('2d');
        //Chart.defaults.global.defaultFontFamily ='Lato';
        //Chart.defaults.global.defaultFontSize = 18;
        //Chart.defaults.global.defaultFontColor = '#777';

        let massPopChart = new Chart(myChart, {
           type: 'bar', //bar, horizontalBar, Pie, line, doughnut, radar, polarArea
           data: {
            labels:['Boston', 'Worcester', 'lowell', 'Springfield', 'Cambridge', 'New Bedford', ],
            datasets:[{
                label: 'population',
                data: [
                    617590,
                    181045,
                    164560,
                    153060,
                    106519,
                    105162,
                ],
                //backgroundColor: 'green'
                backgroundColor: [
                    'rgba(255, 99, 132, 0.6)',
                    'rgba(54, 162, 235, 0.6)',
                    'rgba(65, 59, 102, 0.6)',
                    'rgba(255, 206, 86, 0.6)',
                    'rgba(75, 192, 192, 0.6)',
                    'rgba(153, 102, 255, 0.6)'
                ], 
                borderWidth:1,
                borderColor: '#777',
                hoverBorderWidth: 3,
                hoverBorderColor:'#000'
            }]
           },
           options: {
            plugins:{
            title:{
                display: true,
                text:'Largest Cities in Massachusets',
            },
            legend: {
                position: 'right',
                labels:{
                    fontColor: '#000'
                }
            }
           }
        }

        });
    </script>
</body>
</html>